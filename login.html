<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />

  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />

  <meta
    name="apple-mobile-web-app-status-bar-style"
    content="black-translucent"
  >

  <title>Welcome Â· Spendr</title>

  <!-- ðŸ”’ DARK SAFETY NET -->
  <style>
    html {
      background: #0b0f14;
    }
  </style>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="login.css?v=2026-01-22.1">
</head>


<body>
  <div class="page login-page">
    <main class="screen">
      <div class="content">
        <img src="icon-180.png" alt="Spendr" class="logo" />

        <h1 class="welcome">
          <span class="welcome-sub">Welcome to</span>
          <span class="welcome-brand">Spendr</span>
        </h1>

        <p class="tagline">
          Track your spending.<br />
          Stay intentional.
        </p>
      </div>

      <div class="actions">
        <button id="googleLogin" class="google-btn auth-btn">
          <img
            src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg"
            alt=""
          />
          Continue with Google
        </button>

        <p class="privacy">
          We donâ€™t store passwords.<br />
          Sign-in is handled securely by Google.
        </p>
      </div>
    </main>
  </div>

  <!-- Firebase (compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyBn2kufYDw1It3d-yuf351ApSv54w_57Gk",
      authDomain: "spendr-39376.firebaseapp.com",
      projectId: "spendr-39376"
    };

    // Init Firebase (safe)
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }

    const auth = firebase.auth();
    const provider = new firebase.auth.GoogleAuthProvider();

    // Handle redirect result (important even if you prefer popup)
    auth.getRedirectResult()
      .then(result => {
        if (result.user) {
          window.location.replace("/balances.html");
        }
      })
      .catch(console.error);

    // Auth state listener
    auth.onAuthStateChanged(user => {
      if (user) {
        window.location.replace("/balances.html");
      }
    });

    // Login button
    const loginBtn = document.getElementById("googleLogin");

    loginBtn.addEventListener("click", async () => {
      loginBtn.disabled = true;

      try {
        // Try popup first
        await auth.signInWithPopup(provider);
      } catch (popupError) {
        console.warn("Popup failed, using redirect:", popupError);
        await auth.signInWithRedirect(provider);
      }
    });
  </script>
</body>
</html>